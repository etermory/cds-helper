<Window x:Class="cds_helper.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:cds_helper"
        mc:Ignorable="d"
        Title="대항해시대3 세이브 뷰어" Height="600" Width="1200">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- TabControl -->
        <TabControl Grid.Row="0" Margin="5">
            <!-- 캐릭터 탭 -->
            <TabItem Header="캐릭터">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 상단 버튼 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                        <Button Name="BtnLoadSave" Content="세이브 파일 읽기" Width="120" Height="30" Click="BtnLoadSave_Click" Margin="0,0,10,0"/>
                        <CheckBox Name="ChkShowGray" Content="미등장 캐릭터 표시" VerticalAlignment="Center" Margin="10,0,10,0"
                                  Checked="ChkShowGray_Changed" Unchecked="ChkShowGray_Changed"/>
                        <TextBlock Text="이름 검색:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox Name="TxtNameSearch" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                 TextChanged="TxtNameSearch_Changed"/>
                        <CheckBox Name="ChkFilterSkill" Content="특기 필터:" VerticalAlignment="Center" Margin="10,0,5,0"
                                  Checked="ChkFilterSkill_Changed" Unchecked="ChkFilterSkill_Changed"/>
                        <ComboBox Name="CmbSkill" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,5,0"
                                  SelectionChanged="CmbSkill_Changed"/>
                        <TextBlock Text="Lv:" VerticalAlignment="Center" Margin="5,0,5,0"/>
                        <ComboBox Name="CmbLevel" Width="50" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                  SelectionChanged="CmbLevel_Changed"/>
                        <TextBlock Name="TxtFilePath" VerticalAlignment="Center" Text="파일 경로: 없음" />
                    </StackPanel>

                    <!-- 데이터 그리드 -->
                    <DataGrid Grid.Row="1" Name="DgCharacters"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              Margin="10"
                              AlternatingRowBackground="LightGray">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsGray}" Value="True">
                                        <Setter Property="Foreground" Value="#888888"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="이름" Binding="{Binding Name}" Width="150"/>
                            <DataGridTextColumn Header="체력" Binding="{Binding HP}" Width="50"/>
                            <DataGridTextColumn Header="지력" Binding="{Binding Intelligence}" Width="50"/>
                            <DataGridTextColumn Header="무력" Binding="{Binding Strength}" Width="50"/>
                            <DataGridTextColumn Header="매력" Binding="{Binding Charm}" Width="50"/>
                            <DataGridTextColumn Header="운" Binding="{Binding Luck}" Width="50"/>
                            <DataGridTextColumn Header="특기" Binding="{Binding Skills}" Width="*"/>
                            <DataGridTextColumn Header="명성" Binding="{Binding Fame}" Width="60"/>
                            <DataGridTextColumn Header="소재" Binding="{Binding Location}" Width="100"/>
                            <DataGridTextColumn Header="연령" Binding="{Binding Age}" Width="50"/>
                            <DataGridTextColumn Header="얼굴" Binding="{Binding Face}" Width="50"/>
                            <DataGridTextColumn Header="성좌" Binding="{Binding Constellation}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- 도서 탭 -->
            <TabItem Header="도서">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 도서 검색 필터 -->
                    <WrapPanel Grid.Row="0" Margin="10" Orientation="Horizontal">
                        <TextBlock Text="도서명:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Name="TxtBookSearch" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                 TextChanged="TxtBookSearch_Changed"/>

                        <TextBlock Text="게제 힌트:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox Name="TxtHintSearch" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                 TextChanged="TxtHintSearch_Changed"/>

                        <TextBlock Text="언어:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <ComboBox Name="CmbLanguage" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                  SelectionChanged="CmbLanguage_Changed"/>

                        <TextBlock Text="필요 스킬:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <ComboBox Name="CmbRequiredSkill" Width="120" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                  SelectionChanged="CmbRequiredSkill_Changed"/>

                        <Button Name="BtnResetBookFilter" Content="필터 초기화" Width="100" Height="30"
                                Click="BtnResetBookFilter_Click" Margin="10,0,0,0"/>
                    </WrapPanel>

                    <!-- 도서 데이터 그리드 -->
                    <DataGrid Grid.Row="1" Name="DgBooks"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              Margin="10"
                              AlternatingRowBackground="LightGray">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="도서명" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="언어" Binding="{Binding Language}" Width="150"/>
                            <DataGridTextColumn Header="소재 도서관" Binding="{Binding Library}" Width="*" MinWidth="200"/>
                            <DataGridTextColumn Header="게제 힌트" Binding="{Binding Hint}" Width="200"/>
                            <DataGridTextColumn Header="필요" Binding="{Binding Required}" Width="100"/>
                            <DataGridTextColumn Header="개제조건" Binding="{Binding Condition}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- 도시 탭 -->
            <TabItem Header="도시">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 도시 검색 필터 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                        <TextBlock Text="도시명 검색:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Name="TxtCitySearch" Width="150" Height="25" VerticalAlignment="Center" Margin="0,0,10,0"
                                 TextChanged="TxtCitySearch_Changed"/>

                        <CheckBox Name="ChkLibraryOnly" Content="도서관 있는 도시만" VerticalAlignment="Center" Margin="10,0,10,0"
                                  Checked="ChkLibraryOnly_Changed" Unchecked="ChkLibraryOnly_Changed"/>

                        <Button Name="BtnResetCityFilter" Content="필터 초기화" Width="100" Height="30"
                                Click="BtnResetCityFilter_Click" Margin="10,0,0,0"/>
                    </StackPanel>

                    <!-- 도시 데이터 그리드 -->
                    <DataGrid Grid.Row="1" Name="DgCities"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              Margin="10"
                              AlternatingRowBackground="LightGray">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="도시명" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="위도" Binding="{Binding LatitudeDisplay}" Width="100"/>
                            <DataGridTextColumn Header="경도" Binding="{Binding LongitudeDisplay}" Width="100"/>
                            <DataGridCheckBoxColumn Header="도서관" Binding="{Binding HasLibrary}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- 지도 탭 -->
            <TabItem Header="지도">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 상단 컨트롤 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                        <TextBlock Text="대항해시대3 발견물 지도" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Button Name="BtnZoomIn" Content="확대 +" Width="60" Height="30" Margin="20,0,5,0" Click="BtnZoomIn_Click"/>
                        <Button Name="BtnZoomOut" Content="축소 -" Width="60" Height="30" Margin="5,0,5,0" Click="BtnZoomOut_Click"/>
                        <Button Name="BtnZoomReset" Content="원본" Width="60" Height="30" Margin="5,0,0,0" Click="BtnZoomReset_Click"/>
                        <TextBlock Name="TxtMapCoordinates" Text="좌표: -" VerticalAlignment="Center" Margin="20,0,0,0" FontFamily="Consolas"/>
                    </StackPanel>

                    <!-- 지도 이미지 -->
                    <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                                  Margin="10" Name="MapScrollViewer"
                                  PreviewMouseWheel="MapScrollViewer_PreviewMouseWheel"
                                  PreviewMouseLeftButtonDown="MapScrollViewer_PreviewMouseLeftButtonDown"
                                  PreviewMouseMove="MapScrollViewer_PreviewMouseMove"
                                  PreviewMouseLeftButtonUp="MapScrollViewer_PreviewMouseLeftButtonUp">
                        <Grid>
                            <Image Name="ImgMap"
                                   Stretch="None"
                                   RenderTransformOrigin="0,0"
                                   MouseMove="ImgMap_MouseMove"
                                   MouseLeave="ImgMap_MouseLeave">
                                <Image.RenderTransform>
                                    <ScaleTransform x:Name="MapScaleTransform" ScaleX="0.3" ScaleY="0.3"/>
                                </Image.RenderTransform>
                            </Image>
                            <Canvas Name="MapCanvas"
                                    RenderTransformOrigin="0,0">
                                <Canvas.RenderTransform>
                                    <ScaleTransform x:Name="CanvasScaleTransform" ScaleX="0.3" ScaleY="0.3"/>
                                </Canvas.RenderTransform>
                            </Canvas>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- 하단 상태바 -->
        <StatusBar Grid.Row="1">
            <StatusBarItem>
                <TextBlock Name="TxtStatus" Text="준비됨" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
